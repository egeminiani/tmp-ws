<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Penalized Factor Analysis: grid search • penfa</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Penalized Factor Analysis: grid search">
<meta property="og:description" content="penfa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">penfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/penalized-factor-analysis-grid.html">Penalized Factor Analysis: grid search</a>
    </li>
    <li>
      <a href="../articles/penalized-factor-analysis.html">Penalized Factor Analysis</a>
    </li>
    <li>
      <a href="../articles/penalized-multigroup-factor-analysis.html">Penalized Multiple-group Factor Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="penalized-factor-analysis-grid_files/header-attrs-2.5/header-attrs.js"></script><link href="penalized-factor-analysis-grid_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="penalized-factor-analysis-grid_files/anchor-sections-1.0/anchor-sections.js"></script><script src="penalized-factor-analysis-grid_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="penalized-factor-analysis-grid_files/plotly-binding-4.9.2.1/plotly.js"></script><script src="penalized-factor-analysis-grid_files/typedarray-0.1/typedarray.min.js"></script><script src="penalized-factor-analysis-grid_files/jquery-3.5.1/jquery.min.js"></script><link href="penalized-factor-analysis-grid_files/crosstalk-1.1.1.9000/css/crosstalk.css" rel="stylesheet">
<script src="penalized-factor-analysis-grid_files/crosstalk-1.1.1.9000/js/crosstalk.min.js"></script><link href="penalized-factor-analysis-grid_files/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="penalized-factor-analysis-grid_files/plotly-main-1.52.2/plotly-latest.min.js"></script><link href="penalized-factor-analysis-grid_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="penalized-factor-analysis-grid_files/datatables-binding-0.16/datatables.js"></script><link href="penalized-factor-analysis-grid_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="penalized-factor-analysis-grid_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="penalized-factor-analysis-grid_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script src="penalized-factor-analysis-grid_files/jszip-1.10.20/jszip.min.js"></script><script src="penalized-factor-analysis-grid_files/pdfmake-1.10.20/pdfmake.js"></script><script src="penalized-factor-analysis-grid_files/pdfmake-1.10.20/vfs_fonts.js"></script><link href="penalized-factor-analysis-grid_files/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="penalized-factor-analysis-grid_files/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script><script src="penalized-factor-analysis-grid_files/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script><script src="penalized-factor-analysis-grid_files/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script><script src="penalized-factor-analysis-grid_files/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script><script src="penalized-factor-analysis-grid_files/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script><link href="penalized-factor-analysis-grid_files/dt-ext-scroller-1.10.20/css/scroller.dataTables.min.css" rel="stylesheet">
<script src="penalized-factor-analysis-grid_files/dt-ext-scroller-1.10.20/js/dataTables.scroller.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Penalized Factor Analysis: grid search</h1>
                        <h4 class="author">Elena Geminiani</h4>
            
      
      
      <div class="hidden name"><code>penalized-factor-analysis-grid.Rmd</code></div>

    </div>

    
    
<style>
body {
text-align: justify}
</style>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p><strong>Aim</strong>. This vignette shows how to fit a penalized factor analysis model with the scad and mcp penalties using the routines in the <code>penfa</code> package. The employed penalty is aimed at encouraging sparsity in the factor loading matrix. Since the scad and mcp penalties cannot be used with the automatic tuning procedure (see <span class="citation">Geminiani, Marra, and Moustaki (2021)</span> for details), the optimal tuning parameter will be found through grid searches.</p>
<p><strong>Data</strong>. The <a href="https://github.com/Jo-Karl/ccpsyc/tree/master/data">data set</a> used for illustration purposes is included in the <a href="https://github.com/Jo-Karl/ccpsyc/"><code>ccpsych</code></a> package for cross-cultural analysis. The data set collects the answers (on a 1–7 Likert-type scale) of employees from several countries on their attitude of helping other employees and giving communications and suggestions aimed at improving the work conditions and products. <span class="citation">Fischer and Karl (2019)</span> hypothesize the existence of two constructs: <strong>help</strong>, defined by the first seven items (renamed here <code>h1</code> to <code>h7</code>), and <strong>voice</strong>, represented by the other five items (<code>v1</code> to <code>v5</code>).</p>
<p>The following analysis is meant as a demo of the capabilities of the <code>penfa</code> package; please refer to <span class="citation">Fischer et al. (2019)</span> and <span class="citation">Fischer and Karl (2019)</span> for a thorough description and analysis of these data. The <code>ccdata</code> set included in the <code>penfa</code> package has already undergone some preliminary pre-processing. This includes considering the employees from the two countries of Lebanon and Taiwan, centering, scaling, and renaming the items.</p>
<p>Let us load and inspect the pre-processed data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">penfa</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ccdata</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ccdata</span><span class="op">)</span>
<span class="co">##    country                h1                 h2                h3                 h4         </span>
<span class="co">##  Length:767         Min.   :-2.62004   Min.   :-2.9034   Min.   :-2.63082   Min.   :-3.0441  </span>
<span class="co">##  Class :character   1st Qu.:-0.69516   1st Qu.:-0.2163   1st Qu.:-0.70356   1st Qu.:-0.2720  </span>
<span class="co">##  Mode  :character   Median :-0.05354   Median : 0.4554   Median :-0.06114   Median : 0.4211  </span>
<span class="co">##                     Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000  </span>
<span class="co">##                     3rd Qu.: 0.58809   3rd Qu.: 0.4554   3rd Qu.: 0.58128   3rd Qu.: 0.4211  </span>
<span class="co">##                     Max.   : 1.22971   Max.   : 1.1272   Max.   : 1.22370   Max.   : 1.1141  </span>
<span class="co">##        h5                h6                h7                v1                  v2           </span>
<span class="co">##  Min.   :-2.9105   Min.   :-2.9541   Min.   :-2.8364   Min.   :-2.627694   Min.   :-2.674430  </span>
<span class="co">##  1st Qu.:-0.8662   1st Qu.:-0.9092   1st Qu.:-0.7860   1st Qu.:-0.660770   1st Qu.:-0.671219  </span>
<span class="co">##  Median : 0.4966   Median : 0.4541   Median :-0.1025   Median :-0.005129   Median :-0.003482  </span>
<span class="co">##  Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.000000   Mean   : 0.000000  </span>
<span class="co">##  3rd Qu.: 0.4966   3rd Qu.: 0.4541   3rd Qu.: 0.5810   3rd Qu.: 0.650512   3rd Qu.: 0.664255  </span>
<span class="co">##  Max.   : 1.1781   Max.   : 1.1358   Max.   : 1.2645   Max.   : 1.306154   Max.   : 1.331992  </span>
<span class="co">##        v3                 v4                 v5          </span>
<span class="co">##  Min.   :-2.65214   Min.   :-2.65722   Min.   :-2.51971  </span>
<span class="co">##  1st Qu.:-0.68800   1st Qu.:-0.68041   1st Qu.:-0.61127  </span>
<span class="co">##  Median :-0.03329   Median :-0.02148   Median : 0.02488  </span>
<span class="co">##  Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.00000  </span>
<span class="co">##  3rd Qu.: 0.62142   3rd Qu.: 0.63746   3rd Qu.: 0.66103  </span>
<span class="co">##  Max.   : 1.27613   Max.   : 1.29639   Max.   : 1.29718</span></code></pre></div>
</div>
<div id="model-specification" class="section level2">
<h2 class="hasAnchor">
<a href="#model-specification" class="anchor"></a>Model specification</h2>
<p>Before fitting the model, we need to write a model syntax describing the relationships between the items and the latent factors. To facilitate its formulation, the rules for the syntax specification broadly follow the ones required by <a href="https://cran.r-project.org/web/packages/lavaan/">lavaan</a>. The syntax must be enclosed in single quotes <code>' '</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">syntax</span> <span class="op">=</span> <span class="st">'help  =∼   h1 + h2 + h3 + h4 + h5 + h6 + h7 + 0*v1 + v2 + v3 + v4 + v5
          voice =∼ 0*h1 + h2 + h3 + h4 + h5 + h6 + h7 +   v1 + v2 + v3 + v4 + v5'</span></code></pre></div>
<p>The factors <code>help</code> and <code>voice</code> appear on the left-hand side, whereas the observed variables on the left-hand side. Following the rationale in <span class="citation">Geminiani, Marra, and Moustaki (2021)</span>, we only specify the minimum number of identification constraints. We are setting the scales of the factors by fixing their factor variances to 1. This can be done in one of two ways: 1) by adding <code>'help ~~ 1*help'</code> and <code>'voice ~~ 1*help'</code> to the syntax above; or 2) by setting the argument <code>std.lv = TRUE</code> in the fitting function (see below). To avoid rotational freedom, we fix one loading per factor to zero. Parameters can be easily fixed to user-defined values through the pre-multiplication mechanism. By default, unique variances are automatically added to the model, and the factors are allowed to correlate. These specifications can be modified by altering the syntax (see <code><a href="../reference/penfa.html">?penfa</a></code> for details on how to write the model syntax).</p>
</div>
<div id="model-fitting" class="section level2">
<h2 class="hasAnchor">
<a href="#model-fitting" class="anchor"></a>Model fitting</h2>
<p>The core of the package is given by the <code>penfa</code> function, a short form for <em>PENalized Factor Analysis</em>, that implements the framework discussed in <span class="citation">Geminiani, Marra, and Moustaki (2021)</span> and <span class="citation">Geminiani (2020)</span>. If users decide for either the <code>scad</code> or <code>mcp</code> penalties, they need to use <code>strategy = "grid"</code> since the automatic procedure is not feasible.</p>
<div id="scad" class="section level3">
<h3 class="hasAnchor">
<a href="#scad" class="anchor"></a>Scad</h3>
<p>We start off with the scad. In the function call, we now specify <code>pen.shrink = "lasso"</code>, and we provide through the <code>eta</code> argument the fixed value of the tuning parameter to be employed during optimization. The name given to the starting value (here, the factor loading matrix <code>"lambda"</code>) reflects the parameter matrix to be penalized. By default, all of its elements are penalized, which means here that the penalization is applied to all of the factor loadings (except the ones fixed for identification). The scad penalty relies on an additional shape parameter, which is set by default to 3.7 <span class="citation">(Fan and Li 2001)</span>. This value can be conveniently modified by users through the <code>a.scad</code> argument. See <code><a href="../reference/penfaOptions.html">?penfaOptions</a></code> for additional details on the possible options.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scad.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfa.html">penfa</a></span><span class="op">(</span><span class="co">## factor model</span>
                  model  <span class="op">=</span> <span class="va">syntax</span>,
                  data   <span class="op">=</span> <span class="va">ccdata</span>,
                  std.lv <span class="op">=</span> <span class="cn">TRUE</span>,
                  <span class="co">## penalization</span>
                  pen.shrink <span class="op">=</span> <span class="st">"scad"</span>,
                  eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
                  <span class="co">## fixed tuning</span>
                  strategy <span class="op">=</span> <span class="st">"fixed"</span>,
                  verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Largest absolute gradient value: 0.0005886804</span>
<span class="co">## Fisher information matrix is positive definite</span>
<span class="co">## Eigenvalue range: [47.25864, 74610.35]</span>
<span class="co">## Trust region iterations: 40 </span>
<span class="co">## Factor solution: admissible </span>
<span class="co">## Computing VCOV ... done.</span>
<span class="co">## Effective degrees of freedom: 32.00964</span></code></pre></div>
<div id="grid-search" class="section level4">
<h4 class="hasAnchor">
<a href="#grid-search" class="anchor"></a>Grid search</h4>
<p>In order to find the optimal value of the tuning parameter, a grid search needs to be conducted. The optimal model is the one associated with the lowest GBIC (Generalized Bayesian Information Criterion). For demo purposes, we use a grid of 51 values evenly spaced between 0 and 0.1. However, for accurate analyses, please consider finer grids (of at least 200 elements) with an upper bound sensible for the data at hand.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Grid of values for tuning parameter (list-form)</span>
<span class="va">eta.grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, length.out <span class="op">=</span> <span class="fl">51</span><span class="op">)</span>

<span class="co"># Return GBIC from a converged and admissible penfa model with fixed tuning</span>
<span class="va">penfa.fixedTun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">eta</span>, <span class="va">penalty</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">fitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfa.html">penfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">syntax</span>, data <span class="op">=</span> <span class="va">ccdata</span>, 
                  std.lv <span class="op">=</span> <span class="cn">TRUE</span>, pen.shrink <span class="op">=</span> <span class="va">penalty</span>, 
                  eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="va">eta</span><span class="op">)</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
                  strategy <span class="op">=</span> <span class="st">"fixed"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span>
  
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">fitted</span><span class="op">@</span><span class="va">Vcov</span><span class="op">$</span><span class="va">solution</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">fitted</span><span class="op">@</span><span class="va">Vcov</span><span class="op">$</span><span class="va">admissibility</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">fitted</span><span class="op">@</span><span class="va">Inference</span><span class="op">$</span><span class="va">IC</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">GBIC.scad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">eta.grid</span>, <span class="va">penfa.fixedTun</span>, penalty <span class="op">=</span> <span class="st">"scad"</span><span class="op">)</span> <span class="co"># additional penfaOptions can be passed</span></code></pre></div>
<p>We can plot <code>GBIC</code> values across the tuning values.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">optimtun.scad</span> <span class="op">&lt;-</span> <span class="va">eta.grid</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">GBIC.scad</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>
  
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">eta.grid</span>, y <span class="op">=</span> <span class="va">GBIC.scad</span>, type <span class="op">=</span> <span class="st">'scatter'</span>, mode <span class="op">=</span> <span class="st">'lines'</span><span class="op">)</span>
<span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/layout.html">layout</a></span><span class="op">(</span><span class="va">p</span>, xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>showline <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
               title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"GBIC values across tuning parameters"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p></p>
<div id="htmlwidget-a0cdf1f1904f9c71b4d9" style="width:576px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a0cdf1f1904f9c71b4d9">{"x":{"visdat":{"454c7fee1935":["function () ","plotlyVisDat"]},"cur_data":"454c7fee1935","attrs":{"454c7fee1935":{"x":[0,0.002,0.004,0.006,0.008,0.01,0.012,0.014,0.016,0.018,0.02,0.022,0.024,0.026,0.028,0.03,0.032,0.034,0.036,0.038,0.04,0.042,0.044,0.046,0.048,0.05,0.052,0.054,0.056,0.058,0.06,0.062,0.064,0.066,0.068,0.07,0.072,0.074,0.076,0.078,0.08,0.082,0.084,0.086,0.088,0.09,0.092,0.094,0.096,0.098,0.1],"y":[17396.1792565921,17389.6381041649,17383.2926563352,17379.9066385034,17376.766419856,17376.410558175,17366.7044811975,17363.7955046689,17361.9623766792,17359.7359863997,17357.9961176712,17356.6596768243,17355.6179026994,17354.9897581919,17354.5937182032,17354.2846261666,17354.0583955311,17353.8951941758,17353.7606357444,17353.6489900315,17353.4444917343,17353.7553938161,17353.4615951259,17353.1895726601,17352.8052248731,17352.4624149766,17352.2876113808,17351.8159561802,17351.306306539,17350.8642696837,17350.3711186799,17349.8988068675,17349.5029140981,17349.1586542158,17348.8380496944,17348.6068705551,17349.0346381527,17349.1156303453,17349.2063902886,17349.3188132048,17349.5551116351,17349.7574990224,17349.9538948193,17350.1438457316,17350.324164454,17350.5012800874,17350.6715523395,17350.6615429179,17350.3123240374,17350.321298309,17349.9885727922],"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"showline":true,"title":[]},"title":{"text":"GBIC values across tuning parameters"},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0,0.002,0.004,0.006,0.008,0.01,0.012,0.014,0.016,0.018,0.02,0.022,0.024,0.026,0.028,0.03,0.032,0.034,0.036,0.038,0.04,0.042,0.044,0.046,0.048,0.05,0.052,0.054,0.056,0.058,0.06,0.062,0.064,0.066,0.068,0.07,0.072,0.074,0.076,0.078,0.08,0.082,0.084,0.086,0.088,0.09,0.092,0.094,0.096,0.098,0.1],"y":[17396.1792565921,17389.6381041649,17383.2926563352,17379.9066385034,17376.766419856,17376.410558175,17366.7044811975,17363.7955046689,17361.9623766792,17359.7359863997,17357.9961176712,17356.6596768243,17355.6179026994,17354.9897581919,17354.5937182032,17354.2846261666,17354.0583955311,17353.8951941758,17353.7606357444,17353.6489900315,17353.4444917343,17353.7553938161,17353.4615951259,17353.1895726601,17352.8052248731,17352.4624149766,17352.2876113808,17351.8159561802,17351.306306539,17350.8642696837,17350.3711186799,17349.8988068675,17349.5029140981,17349.1586542158,17348.8380496944,17348.6068705551,17349.0346381527,17349.1156303453,17349.2063902886,17349.3188132048,17349.5551116351,17349.7574990224,17349.9538948193,17350.1438457316,17350.324164454,17350.5012800874,17350.6715523395,17350.6615429179,17350.3123240374,17350.321298309,17349.9885727922],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script> We can ultimately fit the model with the optimal tuning parameter (here, 0.07), that is, the one generating the penalized model with the lowest GBIC. The <code>summary</code> method details information on the model characteristics, the optimization and penalization procedures as well as the parameter estimates with associated standard errors and confidence intervals. The <em>Type</em> column distinguishes between the <em>fixed</em> parameters set to specific values for identification, the <em>free</em> parameters that have been estimated through ordinary maximum likelihood, and the penalized (<em>pen</em>) parameters. The standard errors here have been computed as the square root of the inverse of the penalized Fisher information matrix. The last columns report 95% confidence intervals (CI) for the model parameters. Standard errors and CI of the penalized parameters shrunken to zero are not reported (see <code><a href="../reference/penfaParEstim.html">?penfaParEstim</a></code> to get the complete parameter table). A different significance level can be specified through the <code>level</code> argument in the <code>summary</code> call.
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scad.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfa.html">penfa</a></span><span class="op">(</span><span class="co">## factor model </span>
                  model <span class="op">=</span> <span class="va">syntax</span>, 
                  data <span class="op">=</span> <span class="va">ccdata</span>, 
                  std.lv <span class="op">=</span> <span class="cn">TRUE</span>, 
                  <span class="co">## penalization</span>
                  pen.shrink <span class="op">=</span> <span class="st">"scad"</span>, 
                  <span class="co"># optimal tuning</span>
                  eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="va">optimtun.scad</span><span class="op">)</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
                  strategy <span class="op">=</span> <span class="st">"fixed"</span>, 
                  verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">scad.fit</span><span class="op">)</span>
<span class="co">## penfa 0.0.0.9000 reached convergence</span>
<span class="co">## </span>
<span class="co">##   Number of observations                                    767</span>
<span class="co">##   Number of groups                                            1</span>
<span class="co">##   Number of observed variables                               12</span>
<span class="co">##   Number of latent factors                                    2</span>
<span class="co">##                                                                </span>
<span class="co">##   Estimator                                                PMLE</span>
<span class="co">##   Optimization method                              trust-region</span>
<span class="co">##   Information                                            fisher</span>
<span class="co">##   Strategy                                                fixed</span>
<span class="co">##   Number of iterations                                       41</span>
<span class="co">##   Number of parameters:                                        </span>
<span class="co">##     Free                                                     13</span>
<span class="co">##     Penalized                                                22</span>
<span class="co">##   Effective degrees of freedom                           27.126</span>
<span class="co">##   GIC                                                 17222.675</span>
<span class="co">##   GBIC                                                17348.607</span>
<span class="co">##                                                                </span>
<span class="co">##   Penalty function:                                            </span>
<span class="co">##     Sparsity                                               scad</span>
<span class="co">##                                                                </span>
<span class="co">##   Additional tuning parameter                                  </span>
<span class="co">##     scad                                                    3.7</span>
<span class="co">##                                                                </span>
<span class="co">##   Optimal tuning parameter:                                    </span>
<span class="co">##     Sparsity                                                   </span>
<span class="co">##      - Factor loadings                                    0.070</span>
<span class="co">##                                                                </span>
<span class="co">## </span>
<span class="co">## Parameter Estimates:</span>
<span class="co">## </span>
<span class="co">## Latent Variables:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help =~                                                      </span>
<span class="co">##     h1               pen       0.782    0.030    0.723    0.842</span>
<span class="co">##     h2               pen       0.875    0.029    0.819    0.931</span>
<span class="co">##     h3               pen       0.790    0.030    0.731    0.850</span>
<span class="co">##     h4               pen       0.905    0.030    0.847    0.964</span>
<span class="co">##     h5               pen       0.799    0.040    0.720    0.877</span>
<span class="co">##     h6               pen       0.755    0.044    0.669    0.842</span>
<span class="co">##     h7               pen       0.492    0.051    0.392    0.591</span>
<span class="co">##     v1             fixed       0.000             0.000    0.000</span>
<span class="co">##     v2               pen       0.000                           </span>
<span class="co">##     v3               pen       0.005                           </span>
<span class="co">##     v4               pen       0.000                           </span>
<span class="co">##     v5               pen      -0.000                           </span>
<span class="co">##   voice =~                                                     </span>
<span class="co">##     h1             fixed       0.000             0.000    0.000</span>
<span class="co">##     h2               pen      -0.000                           </span>
<span class="co">##     h3               pen       0.000                           </span>
<span class="co">##     h4               pen      -0.007                           </span>
<span class="co">##     h5               pen       0.079    0.031    0.018    0.140</span>
<span class="co">##     h6               pen       0.147    0.039    0.071    0.223</span>
<span class="co">##     h7               pen       0.390    0.050    0.291    0.488</span>
<span class="co">##     v1               pen       0.865    0.029    0.809    0.922</span>
<span class="co">##     v2               pen       0.885    0.028    0.830    0.941</span>
<span class="co">##     v3               pen       0.850    0.030    0.791    0.909</span>
<span class="co">##     v4               pen       0.855    0.029    0.798    0.912</span>
<span class="co">##     v5               pen       0.816    0.030    0.758    0.875</span>
<span class="co">## </span>
<span class="co">## Covariances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help ~~                                                      </span>
<span class="co">##     voice           free       0.874    0.012    0.852    0.897</span>
<span class="co">## </span>
<span class="co">## Variances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##    .h1              free       0.383    0.021    0.341    0.424</span>
<span class="co">##    .h2              free       0.228    0.014    0.201    0.256</span>
<span class="co">##    .h3              free       0.369    0.021    0.329    0.409</span>
<span class="co">##    .h4              free       0.185    0.012    0.161    0.209</span>
<span class="co">##    .h5              free       0.237    0.014    0.209    0.265</span>
<span class="co">##    .h6              free       0.204    0.012    0.180    0.228</span>
<span class="co">##    .h7              free       0.265    0.015    0.236    0.294</span>
<span class="co">##    .v1              free       0.244    0.015    0.214    0.273</span>
<span class="co">##    .v2              free       0.208    0.013    0.182    0.235</span>
<span class="co">##    .v3              free       0.262    0.016    0.231    0.293</span>
<span class="co">##    .v4              free       0.260    0.016    0.230    0.291</span>
<span class="co">##    .v5              free       0.327    0.019    0.290    0.364</span>
<span class="co">##     help           fixed       1.000             1.000    1.000</span>
<span class="co">##     voice          fixed       1.000             1.000    1.000</span></code></pre></div>
</div>
<div id="implied-moments" class="section level4">
<h4 class="hasAnchor">
<a href="#implied-moments" class="anchor"></a>Implied moments</h4>
<p>The implied moments (here, the covariance matrix) can be found via the <code>fitted</code> method.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">implied</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">scad.fit</span><span class="op">)</span>
<span class="va">implied</span>
<span class="co">## $cov</span>
<span class="co">##    h1    h2    h3    h4    h5    h6    h7    v1    v2    v3    v4    v5   </span>
<span class="co">## h1 0.995                                                                  </span>
<span class="co">## h2 0.684 0.994                                                            </span>
<span class="co">## h3 0.618 0.692 0.994                                                      </span>
<span class="co">## h4 0.704 0.787 0.711 0.994                                                </span>
<span class="co">## h5 0.679 0.759 0.686 0.780 0.991                                          </span>
<span class="co">## h6 0.692 0.774 0.699 0.795 0.770 0.991                                    </span>
<span class="co">## h7 0.651 0.728 0.658 0.748 0.729 0.749 0.993                              </span>
<span class="co">## v1 0.592 0.662 0.598 0.679 0.672 0.699 0.709 0.992                        </span>
<span class="co">## v2 0.605 0.677 0.612 0.695 0.688 0.715 0.725 0.766 0.992                  </span>
<span class="co">## v3 0.585 0.654 0.591 0.671 0.664 0.691 0.700 0.739 0.756 0.991            </span>
<span class="co">## v4 0.585 0.654 0.591 0.671 0.664 0.691 0.701 0.740 0.757 0.730 0.992      </span>
<span class="co">## v5 0.558 0.624 0.564 0.641 0.634 0.659 0.669 0.706 0.723 0.697 0.698 0.993</span></code></pre></div>
</div>
<div id="penalty-matrix" class="section level4">
<h4 class="hasAnchor">
<a href="#penalty-matrix" class="anchor"></a>Penalty matrix</h4>
<p>The penalty matrix is stored in <code>scad.fit@Penalize@Sh.info$S.h</code>. It is a diagonal matrix with elements on the diagonal quantifying the extent to which each model parameters has been penalized. The values corresponding to the factor loadings are different from zero, as these are the penalized parameters, whereas the values for the unique variances (<code>h1~~h1</code> to <code>v5~~v5</code>) and the factor covariance (<code>help~~voice</code>) are zero, as these elements were not affected by the penalization. The magnitude of the penalization varies depending on the size of the loading to be penalized: small loadings received a considerable penalty, whereas large loadings a little one.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">scad.fit</span><span class="op">@</span><span class="va">Penalize</span><span class="op">@</span><span class="va">Sh.info</span><span class="op">$</span><span class="va">S.h</span><span class="op">)</span></code></pre></div>
<pre><code>##    help=~h1    help=~h2    help=~h3    help=~h4    help=~h5    help=~h6    help=~h7    help=~v2 
##        0.00        0.00        0.00        0.00        0.00        0.00        0.00   490515.39 
##    help=~v3    help=~v4    help=~v5   voice=~h2   voice=~h3   voice=~h4   voice=~h5   voice=~h6 
##    11355.69   494762.36   529673.71   526895.59   308113.96     8220.33      650.16      215.10 
##   voice=~h7   voice=~v1   voice=~v2   voice=~v3   voice=~v4   voice=~v5      h1~~h1      h2~~h2 
##        0.00        0.00        0.00        0.00        0.00        0.00        0.00        0.00 
##      h3~~h3      h4~~h4      h5~~h5      h6~~h6      h7~~h7      v1~~v1      v2~~v2      v3~~v3 
##        0.00        0.00        0.00        0.00        0.00        0.00        0.00        0.00 
##      v4~~v4      v5~~v5 help~~voice 
##        0.00        0.00        0.00</code></pre>
<p>Applying the <code>plot</code> method to the penalty matrix allows to visualize an interactive heatmap of the log of the absolute value of the estimated penalty matrix. Due to space constraints, it may occur that some of the parameter labels on the axes are hidden. If it is the case, users can zoom in to the area of interest and inspect the corresponding penalty values.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">scad.fit</span><span class="op">@</span><span class="va">Penalize</span><span class="op">@</span><span class="va">Sh.info</span><span class="op">$</span><span class="va">S.h</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-d8ad7806233014dfb60f" style="width:768px;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d8ad7806233014dfb60f">{"x":{"visdat":{"454c71585ae8":["function () ","plotlyVisDat"]},"cur_data":"454c71585ae8","attrs":{"454c71585ae8":{"x":["help=~h1","help=~h2","help=~h3","help=~h4","help=~h5","help=~h6","help=~h7","help=~v2","help=~v3","help=~v4","help=~v5","voice=~h2","voice=~h3","voice=~h4","voice=~h5","voice=~h6","voice=~h7","voice=~v1","voice=~v2","voice=~v3","voice=~v4","voice=~v5","h1~~h1","h2~~h2","h3~~h3","h4~~h4","h5~~h5","h6~~h6","h7~~h7","v1~~v1","v2~~v2","v3~~v3","v4~~v4","v5~~v5","help~~voice"],"y":["help=~h1","help=~h2","help=~h3","help=~h4","help=~h5","help=~h6","help=~h7","help=~v2","help=~v3","help=~v4","help=~v5","voice=~h2","voice=~h3","voice=~h4","voice=~h5","voice=~h6","voice=~h7","voice=~v1","voice=~v2","voice=~v3","voice=~v4","voice=~v5","h1~~h1","h2~~h2","h3~~h3","h4~~h4","h5~~h5","h6~~h6","h7~~h7","v1~~v1","v2~~v2","v3~~v3","v4~~v4","v5~~v5","help~~voice"],"z":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,13.1032139821293,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,9.33756196491322,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,13.1118348678512,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,13.180018344169,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,13.1747595907659,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,12.6382282539229,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,9.01448731369474,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,6.47876048696267,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5.37575709775398,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"colors":["#DCF0F8","#D7ECF5","#D2E9F3","#CEE6F1","#C9E3EE","#C4E0EC","#C0DDEA","#BCDAE8","#B7D7E6","#B3D4E4","#AED0E1","#A9CDDF","#A5CADD","#A0C7DB","#9CC4D9","#98C1D7","#93BED4","#8EBBD2","#8AB8D0","#85B5CE","#80B1CC","#7BAEC9","#75AAC6","#6FA6C3","#69A2C0","#639EBE","#5D9ABB","#5796B8","#5192B5","#4B8EB2","#458AAF","#3F85AC","#3981A9","#337DA6","#2D78A2","#28749E","#236F9A","#216992","#1F638A","#1D5E82","#1B5779","#195171","#174B69","#154560","#133F58","#113850","#0F3248","#0E2C40","#0C2638","#0B2130"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"autorange":"reversed","title":[]},"title":{"text":"Penalty matrix (abs. value and log scale)"},"xaxis":{"domain":[0,1],"automargin":true,"title":[]},"scene":{"zaxis":{"title":[]}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(220,240,248,1)"],["0.0416666666666667","rgba(210,233,243,1)"],["0.0833333333333333","rgba(201,227,238,1)"],["0.125","rgba(192,221,234,1)"],["0.166666666666667","rgba(182,214,230,1)"],["0.208333333333333","rgba(173,207,225,1)"],["0.25","rgba(164,201,220,1)"],["0.291666666666667","rgba(155,195,216,1)"],["0.333333333333333","rgba(145,189,211,1)"],["0.375","rgba(136,183,207,1)"],["0.416666666666667","rgba(126,176,203,1)"],["0.458333333333333","rgba(114,168,197,1)"],["0.5","rgba(102,160,191,1)"],["0.541666666666667","rgba(90,152,185,1)"],["0.583333333333333","rgba(78,144,179,1)"],["0.625","rgba(65,135,173,1)"],["0.666666666666667","rgba(53,126,167,1)"],["0.708333333333333","rgba(41,117,159,1)"],["0.75","rgba(33,106,148,1)"],["0.791666666666667","rgba(29,95,132,1)"],["0.833333333333333","rgba(25,82,114,1)"],["0.875","rgba(21,70,97,1)"],["0.916666666666667","rgba(17,57,81,1)"],["0.958333333333333","rgba(14,44,64,1)"],["1","rgba(11,33,48,1)"]],"showscale":true,"x":["help=~h1","help=~h2","help=~h3","help=~h4","help=~h5","help=~h6","help=~h7","help=~v2","help=~v3","help=~v4","help=~v5","voice=~h2","voice=~h3","voice=~h4","voice=~h5","voice=~h6","voice=~h7","voice=~v1","voice=~v2","voice=~v3","voice=~v4","voice=~v5","h1~~h1","h2~~h2","h3~~h3","h4~~h4","h5~~h5","h6~~h6","h7~~h7","v1~~v1","v2~~v2","v3~~v3","v4~~v4","v5~~v5","help~~voice"],"y":["help=~h1","help=~h2","help=~h3","help=~h4","help=~h5","help=~h6","help=~h7","help=~v2","help=~v3","help=~v4","help=~v5","voice=~h2","voice=~h3","voice=~h4","voice=~h5","voice=~h6","voice=~h7","voice=~v1","voice=~v2","voice=~v3","voice=~v4","voice=~v5","h1~~h1","h2~~h2","h3~~h3","h4~~h4","h5~~h5","h6~~h6","h7~~h7","v1~~v1","v2~~v2","v3~~v3","v4~~v4","v5~~v5","help~~voice"],"z":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,13.1032139821293,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,9.33756196491322,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,13.1118348678512,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,13.180018344169,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,13.1747595907659,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,12.6382282539229,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,9.01448731369474,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,6.47876048696267,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5.37575709775398,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"type":"heatmap","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="factor-scores" class="section level4">
<h4 class="hasAnchor">
<a href="#factor-scores" class="anchor"></a>Factor scores</h4>
<p>Lastly, the factor scores can be calculated via the <code>penfaPredict</code> function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fscores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfaPredict.html">penfaPredict</a></span><span class="op">(</span><span class="va">scad.fit</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-5cd3d1e3357db61409c1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5cd3d1e3357db61409c1">{"x":{"filter":"none","extensions":["Buttons","Scroller"],"data":[[-0.454057468293857,-0.0780346516757571,0.562575034659368,0.0954970277908635,0.360570800359142,-0.627235201117441,0.885683595617818,0.473812653708092,0.777378785279501,0.562575034659368,-0.00245987361435925,-0.315755022181996,1.18829645591772,-1.01206411906055,-0.523530617132448,0.562575034659368,1.26244608151589,0.196352239705251,0.196352239705251,-0.170096041675804,-1.08298298730907,-2.87310216895664,-0.341345441734733,0.317614765392479,-2.86796334618255,0.296300016349732,1.31683802393654,-0.933906966667541,1.25276481759199,1.31683802393654,-0.203072178292921,0.910182444298827,-0.6729441546471,-0.635421150100566,-1.05121997966844,1.31683802393654,-3.2087399117265,-0.405896781392517,0.242079358652982,0.971647516259545,0.513783837025443,0.563377506474429,0.150832604427455,0.371459495851805,1.09314551090279,1.18869161124744,-2.43473048761048,0.829438477224669,-2.04029033381392,1.13729082620107,-0.936401797584427,0.512268380612677,0.861097431078145,0.521177725470214,0.562575034659368,0.562575034659368,-0.141381300571117,0.0837954016060197,-0.00767135361371655,1.27310893195061,0.0699262992009663,-0.14527528739322,-2.33233974504456,0.027566507910358,1.00488095099008,1.13016740385829,0.688071354120384,-0.0519087527489325,0.221537922981041,0.393414430898279,1.31683802393654,1.30847581277281,0.562575034659368,0.682760577341862,0.253343981383069,-3.2087399117265,1.11381584317209,0.191265538776777,1.31683802393654,-0.171941519778959,0.54282859982052,-0.110872931076573,0.54282859982052,-0.191687954617807,-0.945950943894981,-2.35746333668996,1.27201870426307,1.0886476723299,1.0504170334734,-2.38850786078241,1.02982578621633,1.31683802393654,0.562575034659368,-0.211434389456654,-0.191687954617807,0.140661826968357,-0.191687954617807,-0.191687954617807,-0.20005016578154,-0.496192359504158,1.31683802393654,0.810640009031602,-0.566890556597656,0.662803669913144,0.339249273088302,-0.191687954617807,0.0167384851727236,1.29709158909769,-0.398956932136398,-0.152295142372623,1.29175139044534,1.31683802393654,0.41882793733813,0.356188605897395,0.490172954146415,1.08901441994656,-2.05149695490178,1.01249740825609,-0.274281130344582,1.31683802393654,0.562575034659368,0.507270417446461,0.528076329934482,0.205460490156261,0.562575034659368,-0.494254823552782,0.127905038578764,0.562575034659368,0.551190810984253,0.110106102494946,1.13363225782938,0.384429930715127,0.562575034659368,0.562575034659368,1.0601512955084,1.31683802393654,1.07187775466965,0.488966396224454,-2.8671082496972,-0.0274177884525641,0.439635385439534,0.562575034659368,0.439635385439534,0.437556989880289,0.562575034659368,0.489250247971145,0.369332611262692,0.474310474746655,-0.264483002481443,0.562575034659368,0.0600425214458907,0.0600425214458907,-0.071304834270452,0.780216592768316,0.966529142074122,-2.45447692244933,1.25576943523416,1.25276481759199,0.144195232273331,-2.63856618067869,0.562575034659368,0.277249921404061,0.886758323100565,0.837554499618872,1.25576943523416,-1.10400457051202,-0.0770600298942076,-0.264483002481443,0.516162367434781,-1.89459696304876,0.524333277046655,1.06539643053079,0.417443731775948,0.61862826532632,0.613375168926544,1.31683802393654,0.918869279493594,1.1359509610142,-0.556833766567191,0.950426491722226,1.31683802393654,0.562575034659368,-0.955759883932811,0.430132848423174,1.30545380026143,0.38116409789397,-0.690263620694449,1.31683802393654,0.950426491722226,0.562575034659368,0.434428621970267,1.12422450185295,0.501506445956981,0.501506445956981,1.22965413475563,1.31683802393654,1.04876707183329,1.31683802393654,0.237291489819941,0.64426532860964,0.434213649436191,-0.163977834672151,1.30545380026143,0.432109918785448,0.317247696929937,1.31683802393654,0.513252432992074,0.263222822971826,0.535415632853215,0.0966433358625741,0.557217441137798,1.31683802393654,1.31683802393654,1.31683802393654,1.31683802393654,0.562575034659368,-2.78673353939631,1.2442050287634,0.301357055014167,1.31683802393654,1.30847581277281,1.09732234622938,0.388091110071296,0.933631263762788,1.28536512993644,1.07587617332359,0.187471466879062,1.12099747356952,-0.828656664988375,-2.2557376077237,0.677269263247657,1.31683802393654,1.02945400122369,1.31683802393654,1.31683802393654,1.31683802393654,-3.19648371374067,1.31683802393654,1.31683802393654,-2.22366217630504,0.68901932490503,-1.26133759529508,-0.766737198677042,-2.01056646478127,0.451217186779508,0.790021599882032,0.498304250649957,-0.609710377138483,0.501506445956981,1.17140998089976,-0.563087767649158,0.104114682988229,1.31683802393654,-0.528160719634256,-0.190398932439107,-0.498687202074164,-1.07458688135091,-2.63848516037155,-0.50610729276749,0.219860164840205,0.354845354769054,1.30545380026143,1.21700905755307,0.905545273482151,0.562575034659368,0.520969029049139,-1.33843980732748,0.930640360340815,0.53110214065927,0.442756560439415,-0.179961495456557,0.53118215388368,0.584721192990177,1.05089228413558,0.623643623361754,0.355088427766689,1.31683802393654,0.635969625534885,0.828750385512862,-0.329294644071655,0.402566848753451,0.437433239612431,0.345960659743325,0.37936926855221,-1.05109440001317,0.37936926855221,-2.21272871880643,-2.49880369395503,0.23265863862105,-2.45447692244933,-1.57400261011916,0.670415224281013,0.815584929291453,1.08330344170708,0.626845818668778,0.495014219460624,1.31683802393654,1.31683802393654,1.29338510561404,1.31683802393654,1.3045818259507,1.31683802393654,0.620311626014211,1.31683802393654,1.31683802393654,1.31683802393654,0.490139617151084,1.04321817675986,1.31683802393654,0.829498602054601,1.31683802393654,-0.484903500104136,-1.44561237853135,-1.94027130290279,0.226966706685291,1.31683802393654,-1.29382800682532,-0.673195853726268,0.194315485817292,-1.38468173855264,-1.12070760147353,-0.0251592100976764,1.29709158909769,0.00933946240839008,0.164901982272851,0.240686511370594,0.249015374814422,-1.31686033792266,-0.469164760247661,0.457777353971047,-0.653804950384234,-1.42110099287992,-0.164819077583653,-0.475414094072804,0.234063139649523,0.931748199483451,1.05213131983081,-0.264362939940651,-0.495881735222522,-1.51619733216807,-0.222818613131769,-1.28248281458242,-1.36486899763154,-1.37959865622074,-0.961232952605607,0.0335209468814272,-0.186067313020991,-1.16906780456185,1.31683802393654,0.582321469498215,1.03647534887308,1.31683802393654,1.30511156477529,-3.2087399117265,0.679191313572296,-1.13879769335648,0.769484847865403,0.339275120648567,-0.241994608664497,-0.72613534042249,-1.01891902183662,-1.35558736788384,-0.705958218761213,-0.252489787237572,0.0999947655666956,-0.137246181945824,-0.907394188337462,-0.910523726419213,-0.304446505312733,-0.762517077207893,-1.19134675788309,-0.879587071256546,-1.45773636538074,-1.78716173318082,-1.81667972639099,-0.898841001486986,0.370255328162536,0.653844212214244,0.0801918651418675,0.852139666321229,0.486662910654389,0.945578956315535,1.31683802393654,0.973917213370648,-1.43926614945937,-2.39523761793279,-2.79437572050384,-1.52122515214391,-2.11404939589047,-2.15440333752139,-2.35551993037658,-1.75078860265929,-1.45553008462281,-2.13360452917746,-0.857905982760844,-1.48699116778109,-0.653659797948993,0.949856889425549,-0.391245233577889,1.07376081894899,-0.364417822148462,0.322938086219462,-0.191687954617807,1.03432581564007,0.307932498226377,0.562575034659368,0.508183092238715,-0.293517870566944,-0.775675047628486,-0.191687954617807,0.166875228287266,-0.466162898279841,-0.761993448561883,0.331477555612235,0.86198892618467,-1.70021393317216,0.0960534175109975,1.19149865122475,0.837788194950779,-0.203944152603644,0.562575034659368,-0.665280554082451,-0.428189774799065,0.182154414410625,0.562575034659368,-0.179961495456557,0.562575034659368,0.799173092762523,-1.12606352270828,-1.3317212023746,-1.13646270877439,0.209089867102639,0.492478494259588,1.27042535671195,-0.937588732731248,-0.676696432152393,-0.0965383375314923,0.554212823495634,-0.293517870566944,-1.01002415023953,0.440437857254595,0.43147075194066,0.0545851848193488,-0.477262746086378,-0.37557963518231,0.562575034659368,0.825462083337808,0.63023680917057,-2.6493053636888,-0.323681606516453,0.0839400594272956,1.27734515425885,-2.05149695490178,-0.528031203122944,0.902021609013361,1.10052236428195,1.3045818259507,1.31683802393654,0.515371413431201,0.0790145092844038,0.562575034659368,-0.354224883313812,-1.07129031660678,-0.983475594055362,1.15761881910225,-0.764499234845241,0.536780776584351,-0.346534872387233,1.13818737953589,-0.304234669701901,1.13535540742102,-1.05438519443982,-0.351148889265538,0.240971226039515,-0.235405795027563,-0.723858039269773,1.31683802393654,0.211292012929741,-0.895563269541148,0.869119532682328,-0.38243149203402,-0.32373585428865,0.0514372372845218,0.215293525322215,-0.927117183848388,-0.858916869804491,-0.191687954617807,-0.945950943894981,-0.945950943894981,0.498501828314817,-0.877529575749594,-0.837858928836279,-0.58864610816026,-1.00968869298149,-0.549168008000545,1.19701954971659,-1.0096819147534,-0.512139926598946,0.0275471674409763,-0.243542108909833,0.456982413786279,-0.321007588233537,-0.166858221048345,0.426020608224259,-0.355017035605416,-0.462239653757676,0.562575034659368,0.838659150102562,0.442756560439415,-0.191687954617807,-0.942586695897465,0.0281481799707308,-0.191687954617807,-0.203944152603644,-0.191687954617807,0.00545282834791382,-0.656906051145345,-0.387874875401796,-1.05410877372228,-0.945950943894981,-1.06934124368967,-0.22066857493111,1.23505847588975,-0.818758473179875,-1.14476255647769,0.0199327320799247,0.339033607233842,0.562575034659368,-0.211434389456654,0.399165865417336,-0.192914877846138,-0.203353166542805,0.220218870220876,0.603025214212183,-0.485898214362473,0.51937568149802,1.31683802393654,0.666935115586459,0.926443357252349,0.127195951028803,-1.72112038458699,0.562575034659368,0.355444995144568,0.735745552852518,0.471514553525566,-1.43985003085337,0.23884659533648,1.22669626472602,-3.2087399117265,-0.338959886144161,-0.299511446030916,0.640292002702702,-0.240660896847854,-0.591906831802634,-0.87185683216439,-0.156765859388936,0.4306469811306,0.115149560993938,1.11323418122778,0.562575034659368,-0.00968559919006129,0.0245076424959967,1.29232562796487,-0.914000432915908,-1.23205751620915,0.0283265544481576,0.0204668276761946,0.760836216071767,-0.366076543729119,0.725829490773308,-1.70021393317216,-0.229181720029121,1.13844282356952,0.81374853435715,1.10055544900219,-0.00968559919006129,-0.422143070406749,-0.449715350951723,0.501506445956981,0.547635261434878,0.880569571126038,0.96300260826527,0.550848575498117,0.712953717781923,0.15959506711182,0.53110214065927,0.119393283891729,-0.673427634955224,-0.724237402463521,0.219818454038429,1.23150292634038,0.486775369153567,0.562575034659368,-0.142198990000933,-0.170273385838471,-0.444097760256175,-0.417420660305856,0.308595357906511,-0.00200149898001961,0.580138083577652,-0.592832844800795,0.0712104446583153,-0.164406864241799,0.890436009459979,0.205173658394885,1.31683802393654,0.346338485784044,-0.982492721771163,-2.22197773026689,-0.709595958789461,-0.809148504455391,-0.0946109175172137,0.875466483685858,-0.688752207692139,0.0929986104842056,-0.598136399634926,0.606694762631804,-0.919514315483735,-0.995660925504636,0.927077357428669,-1.4868319929794,-0.461294302139142,0.375663768155201,-1.51187226081316,1.23904501290669,1.31683802393654,-0.773426092136376,-0.539007809527929,-0.539007809527929,-0.397876763519692,0.390146420822659,1.13238169724464,-1.2934967059155,0.0852515081458455,0.182063386689994,-1.61214477366984,-0.622398600585405,0.0800444003183706,0.338043998916776,0.799173092762523,-0.863091354864154,-1.29378125921276,0.550848575498117,1.1137724737659,0.927487294494556,1.0504170334734,-0.618233298987033,0.320014488884441,-0.122377328033659,-1.33327843914954,-1.32864126125483,-1.06576941811493,-1.36741576655877,-0.752455832139018,-1.13129663976683,-1.85924800806283,-0.551193993585753,-0.454291464297455,-0.141657229974993,-0.191090858378392,-0.945950943894981,-0.945950943894981,-0.945950943894981,-0.978871573851908,-1.06576941811493,-1.21212847200294,-1.75455169755171,-0.717128312150061,-2.33021721014909,-1.23166649594992,-0.958207141880818,-0.945950943894981,0.880503756357442,1.19470084653177,1.00548584514028,-1.01293192181977,0.0644688690513203,0.613405737877371,-0.191687954617807,-0.556730090538104,-0.377951265671845,0.340084084975346,-0.477506142125499,0.761608924012015,-0.753679657297529,0.433860295193839,-0.975067356832598,1.10928472862846,-0.783806993274234,-0.344223298539929,0.32973120907155,-0.973146915105308,-0.0415589394032756,0.129721781520261,-1.52439731370881,-0.878162197008566,-0.522830450147341,0.251958147720815,-1.18017658176738,-1.90776722848023,-0.237682171345255,0.0315797184407357,-1.46166371419555,-0.21498993900603,0.586576011650352,0.165215267308425,-1.17981872007969,-0.498886352864686,0.562575034659368,0.15111629859037,-0.0225989934981321,-0.18255203668784,-3.06555363834973,0.515356207892653,0.850873888121728,0.528702417167308,0.501506445956981,0.980108336468811,-0.945950943894981,-1.12663182383137,1.04780271326216,-0.367267199425473,-0.285519326564651,0.805700226561696,-2.24117792416779,-0.309786594498685,1.06219548750355,-0.320040937801396,1.31683802393654,-0.250356819828231,0.562575034659368,-0.344303311764339,-0.103335877480516,-0.33884730306641,-0.23803641023013,0.562575034659368,0.562575034659368,-0.610342615920905,-0.941157996500814,0.46683135664986,0.726297024591744,0.976939225882029,0.273437584636859,1.24644269956487,1.31683802393654,0.88886423100577,0.358176879796257,-0.147719608601625,0.954629278345322,-0.668000139882727,0.104088663312258,1.05638445407398,0.726297024591744,-0.159685321793123,0.562575034659368,-0.968608576234521,-1.8545405956951,-0.731504000148501,-0.715733438195793,-0.969641546943247,-1.61169668490016,-1.82336947172321,0.562575034659368,0.339839766775969,1.30011360160908,0.380582200115063,-2.40526966193227],[0.14445124129806,-0.358312953439712,0.694251649538908,0.615306961508651,0.864235548137938,-0.487137862197106,0.992528113666929,0.541156484888298,0.61386940542379,0.694251649538908,0.0308414337859547,-0.0775390585401073,1.3186952361324,-1.00641389529229,0.409047587481072,0.694251649538908,0.89752140777597,-0.152095634844265,-0.152095634844265,-0.043399928683001,-0.972137604442127,-2.49708406232865,0.0180583897874849,0.666562904269361,-2.49054108403439,0.805189680212681,1.43678697198291,-1.01817640953249,1.42953463182563,1.43678697198291,-0.161131981676113,0.817576674084553,-0.859204693885188,-0.293133632979653,-1.83449572530159,1.43678697198291,-3.01842496268111,-0.960523049745585,0.687930212590783,1.24094521834252,0.833136940906727,1.31580561483719,-1.29075875520804,-0.0238082360050336,1.10835434696005,1.42228229166834,-2.08010821174984,0.734837465496271,-1.83409722448953,0.255198256418586,-0.0313105039238908,0.200876382600683,1.0501176124407,0.324019337662487,0.694251649538908,0.694251649538908,0.44509159403313,0.531825331024668,0.20314668099594,1.00857034956082,0.51530332295672,0.406483695878295,-2.26208935095566,-0.121382800753687,0.83182142021585,0.792226244538613,1.11658234365966,-0.839192509491888,-0.458765154021091,0.784709420490385,1.43678697198291,1.35385385226666,0.694251649538908,0.733246322882916,0.607517036344104,-3.01842496268111,0.585602376145471,1.00844097956466,1.43678697198291,0.147497755582172,0.498470221051642,0.154397900222897,0.498470221051642,-0.0482836729050953,-0.790818995349099,-1.95936049453121,0.992511679285752,0.929314000617185,0.535249217320281,-2.06258175230313,0.797577319757382,1.43678697198291,0.694251649538908,-0.244065101392362,-0.0482836729050953,-0.362086769361483,-0.0482836729050953,-0.0482836729050953,-0.131216792621345,-0.337396930696423,1.43678697198291,0.925521798017477,-1.23670087310468,0.469948047051649,0.640093187595156,-0.0482836729050953,0.664911858749258,1.24100554349565,-0.0170720030575044,-0.594128831353094,1.18798761283416,1.43678697198291,-0.0794204519954561,-0.18489400264602,0.3564914937692,-0.177849510266714,-2.23160983794389,1.20394566242286,0.000566510013384589,1.43678697198291,0.694251649538908,0.145904319231921,0.362979431333884,0.335722192066811,0.694251649538908,-0.715730891529947,0.407013800816086,0.694251649538908,0.581403340767891,1.20237364167312,1.41608653806074,0.102452869705618,0.694251649538908,0.694251649538908,1.29820405064963,1.43678697198291,1.40909822671336,-0.0301485013479527,-2.53425008126933,0.00736525250867304,0.0588973949591773,0.694251649538908,0.0588973949591773,0.485660440867206,0.694251649538908,0.565810487027099,-0.0396285784978646,0.417718722794712,-0.166077993609558,0.694251649538908,0.115141436974183,0.115141436974183,0.0425045282068816,0.726171531493454,0.939090199705744,-2.27588964023711,1.42988682734219,1.42953463182563,-0.0557026961851359,-2.3484717686339,0.694251649538908,0.26630733819476,0.97742521282993,0.664292605874104,1.42988682734219,-0.458917611349363,-0.527628314906451,-0.166077993609558,0.239484280755518,-1.71051428300253,0.315135001357886,1.19849040744093,1.07817467401434,0.616616737272666,0.710429623283269,1.43678697198291,0.43428801446232,1.41635056687065,-0.114967091518651,1.39538610413856,1.43678697198291,0.694251649538908,-0.865323434775198,-0.597525851120119,1.3239386632119,-0.465617463927328,-0.453692372084764,1.43678697198291,1.39538610413856,0.694251649538908,0.679746969224334,1.30545639080692,0.687351504898183,0.687351504898183,1.20579214699087,1.43678697198291,1.18535574187861,1.43678697198291,-0.80003152350257,0.582049348534206,0.598390447918158,0.612153833573305,1.3239386632119,0.679482940414417,0.641104491396888,1.43678697198291,-0.642176462738574,0.127297340062419,0.446456373771229,-0.0240203644454694,0.611670725339221,1.43678697198291,1.43678697198291,1.43678697198291,1.43678697198291,0.694251649538908,-2.71686777790708,1.29480798434141,0.305335228509435,1.43678697198291,1.35385385226666,0.94216796171512,0.784093196163906,0.600193795028774,1.13011136743191,-0.347275790491206,-0.627954850494278,1.22589812194263,0.689858165423963,-1.52238886943635,-0.717277935929,1.43678697198291,0.323574579829738,1.43678697198291,1.43678697198291,1.43678697198291,-2.89688394481003,1.43678697198291,1.43678697198291,-2.14150426250898,0.505105148113781,-1.2236370197212,-0.224367257566807,-1.85251483404388,0.223539231498164,0.721047660430144,0.635205781613652,-1.16190056022083,0.687351504898183,1.17701366363694,-0.884929248215334,0.0834485031801137,1.43678697198291,-0.572754677181564,-0.561394206277778,0.448544005370023,-1.17558370801857,-2.91814403945756,-0.720694164044859,-0.260101268447081,0.387280194500015,1.3239386632119,1.02517520223794,0.743551894934176,0.694251649538908,0.287173945010399,-1.49248150756858,0.642202280207847,0.387576044987905,0.680715389067374,0.0626105031586412,0.637644353839308,0.320624836012427,0.457837599393523,0.701151794179634,-0.206576743260694,1.43678697198291,0.948621681758625,1.12940940131879,-0.220822568226281,0.313995437791479,0.680099164740895,0.550005661490944,0.673551215616732,-1.31721223939881,0.673551215616732,-0.670891136854524,-2.08736055190713,0.210694871641117,-2.27588964023711,-1.1334396628733,0.126677673854214,1.38008886608422,-0.846374777020333,0.753297517464165,0.0243633013608368,1.43678697198291,1.43678697198291,1.21499861985544,1.43678697198291,1.31524595411183,1.43678697198291,0.791145467798014,1.43678697198291,1.43678697198291,1.43678697198291,0.604066189665372,1.09549241856504,1.43678697198291,1.13963400598445,1.43678697198291,-0.82177000237958,-1.33077748703789,-1.65880257356406,0.563920735931216,1.43678697198291,-1.38129920723764,-0.685162701582244,0.0035997888587042,-1.25824241955563,-1.31188457221503,-0.397167259169592,1.24100554349565,0.394724639554499,-0.430530389136602,0.729434779847153,0.341729602329224,-1.14516890384338,0.0296544855989483,0.259134882476095,-0.0778189027426508,-1.1671206462105,0.195248333072338,-0.15627915536722,0.145290652233007,1.12252859711412,1.2133167982261,0.373609046534216,-0.72953274546956,-1.28192396389207,-0.35691341016338,-1.42466724507853,-1.57608143977263,-1.33377139582728,-0.936956626874205,-0.19759216379719,-0.223101854014803,-1.30228632575262,1.43678697198291,0.890033078026175,0.987836529302513,1.43678697198291,1.32589279591918,-3.01842496268111,0.655642186725912,-1.15879654153564,0.350106145741316,0.0406719818079363,-0.54165893984332,-0.704887424109387,-1.62707012792737,-1.07924223171345,-0.361554770251484,0.35389228109061,0.532006074753898,0.259711736447326,-1.19932656914929,-1.43032051793807,-0.458910446938476,-0.974444520748131,-0.657013679117723,-0.904381192775798,-1.80399937434965,-1.30050373329563,-1.22177149741188,-0.88998843972752,0.469265421374587,0.971136771799667,0.372256494994455,0.835273143097849,0.393810565909502,1.08654164415437,1.43678697198291,0.821464571548375,-1.33070508543251,-1.68854535477531,-2.86129685161688,-1.41480620666287,-1.75926078196477,-1.70713596377445,-1.8729705795922,-1.70849110133953,-1.38244693199702,-1.94775981133815,-1.00351184552191,-1.56947336812637,-0.00621538369398085,1.20300966151668,-1.01290186668017,0.886763424628018,-0.0354300381106231,0.667179128595839,-0.0482836729050953,-0.171384538159272,0.397822856544202,0.694251649538908,0.154986085331966,-0.871907783237664,-0.652686920454346,-0.0482836729050953,0.0204885632789822,-0.345869229088031,-0.648765886901027,0.034990802732129,0.339716254700304,-1.5333543177931,-0.0671437263348123,1.37084095941693,1.08809346479979,-0.16982469077618,0.694251649538908,-0.354263323628934,-0.138488473214688,-0.141567094756982,0.694251649538908,0.0626105031586412,0.694251649538908,0.639007275092207,-0.651127011436803,-2.5447302995465,-1.22084788373363,0.61719789916984,0.333155341577529,0.982019603199522,-0.70788587563285,-0.707921487327745,-0.150824127814047,0.611318529822659,-0.871907783237664,-0.798071335506387,0.680451360257457,0.0277578030108973,0.259788445978651,-0.606925339140829,-0.0690722735339174,0.694251649538908,0.406116707926203,0.527342578393537,-2.72238670642758,-0.75303322207138,0.478077670549417,1.04522411500838,-2.23160983794389,-0.598447428823496,0.781118506735527,1.38897378752882,1.31524595411183,1.43678697198291,-0.338880699168214,-1.30471240815321,0.694251649538908,-0.528944627094242,-0.856765007915082,-1.2316347130983,0.447067448597298,-0.693130649596397,0.443958418342852,-0.403738993389003,0.877113496962143,0.0128427143812384,1.28443921724405,-0.691506947049616,-0.380850937550289,-0.135489780118615,-0.733555341787974,-0.766975598168143,1.43678697198291,-0.00400387061187845,-0.86711599923454,0.386347804485561,-0.759669337902189,-1.1714557543959,0.626065255018643,0.235682787276963,-0.604119332961878,-0.479504119239492,-0.0482836729050953,-0.790818995349099,-0.790818995349099,0.686999309381621,-1.27892847377417,-0.888176910941301,-0.504432333677898,-1.16279460469977,-0.83630474165075,1.42325071151138,-0.800025468213668,-0.278037766976157,-0.473200234245116,-0.39931471702473,0.575271315253553,-0.697003044232995,-0.395359740070275,-0.643499710449959,-0.297551964632309,-0.0598001647618295,0.694251649538908,0.801366878864638,0.680715389067374,-0.0482836729050953,-0.762857939001612,-0.602020973591064,-0.0482836729050953,-0.16982469077618,-0.0482836729050953,-0.114132498834537,-0.746475998009791,-1.29997260237244,-0.814725587576148,-0.790818995349099,-0.798078185523807,-0.335690930208678,0.636736100493684,-1.57332387305966,-0.500269839961361,-0.0707920315982162,0.230495721167562,0.694251649538908,-0.244065101392362,-0.0953460455856434,0.272604114324672,-0.102182050598876,0.156181189744813,0.4966776565923,-0.556598792691179,0.276681868924169,1.43678697198291,0.534101168854828,-0.0846130794224733,-0.0838189987299017,-2.19675491302039,0.694251649538908,-0.156797099400421,0.139334604751696,0.454211919930239,-0.805309604493474,-0.00218152271270058,0.553802980777435,-3.01842496268111,-1.25537130311705,-0.50799705362193,0.414083249304575,0.0538397878717581,-0.553906241212814,-0.773033124975851,-0.203690972340861,0.57809512757267,0.611695239513201,1.30218164274003,0.694251649538908,0.200742578053395,-0.540157528594772,1.19370493624074,-1.64057614169394,-0.74516135352218,0.402322770183889,-0.851685740605226,0.476423320963881,-0.64230333971359,-0.291117791245743,-1.5333543177931,-0.409387518103765,0.262321918917357,0.0613598283369051,1.04897309398581,0.200742578053395,-0.155060189802301,-1.11233624842077,0.687351504898183,0.546159885306522,0.620460621075829,1.23671961049872,0.583357473475172,0.373878906061989,0.649971847245692,0.387576044987905,-1.32942468076377,-0.468039055103608,-0.319221365855848,-0.339915520361838,0.601492645032315,0.576105133317885,0.694251649538908,-0.600685467332522,0.129650320375339,-0.149823771790847,-0.528564858375719,-0.0822987453484999,0.198384181329628,0.398172300837296,-0.739223657852503,-0.166248119642278,0.0908480695579626,0.621795245597286,-0.628324508195089,1.43678697198291,0.358094735259016,-0.893161822596299,-1.59728924252291,-0.252206432035091,-0.7870368423066,-0.627691586925007,1.09371057262624,-0.629867312884846,0.217909876735013,-0.645179874512568,-0.333877787536068,-0.709369511103504,-1.08119939336432,0.858695295806522,-0.818112533489967,-0.664850312815662,0.339380606060652,-0.200178963699254,1.26402058790969,1.43678697198291,-0.853315709953088,-0.559361496194744,-0.559361496194744,-0.289791909137364,0.611299189386603,1.33874643071365,-1.37501404369077,-0.494261145951877,0.321230002170872,-1.70327502134604,-0.792605000854288,-0.303868712583336,0.115097582364147,0.639007275092207,-1.06976299268992,-2.03293617793452,0.583357473475172,0.482595781295485,0.721729593484998,0.535249217320281,-0.496646394734168,0.097154662255612,-0.908360267835804,-0.559853795141186,-1.20715709285084,-0.804355255820634,-0.962080169894121,-1.04760625556065,-0.927115239256637,-0.710123656834971,-0.17976566392183,-0.537538463706185,-0.0665747219638561,-0.295672824767547,-0.790818995349099,-0.790818995349099,-0.790818995349099,-0.269325339934884,-0.804355255820634,-0.831316644599817,-2.39897035289196,-0.406833187965893,-2.1760565345085,-0.873806035174015,-0.912360013220184,-0.790818995349099,0.499196113256579,1.42298668270146,1.40158185774616,-0.643937760503914,-0.279890514073002,-0.5803398270711,-0.0482836729050953,-0.262566714233397,-0.399411050124269,0.239408556379508,-1.10201443985464,0.605880255296527,-0.657534281465821,0.61529271574132,-1.09704462966484,1.15736462657453,-0.808405199225057,-0.383862467574549,-0.623052090477908,-1.06045177745257,0.132149071125813,0.647885470536597,-0.904551936975955,-0.686732676098418,-1.12860098678771,-1.15506128407416,-1.01419548901385,-1.81277666320149,-0.249618290143617,-0.909418657822185,-1.83873869345866,-0.279308556853732,0.567576239650967,1.20601833747147,-0.824351254566741,-0.729884940986121,0.694251649538908,-0.0544270710621926,-0.586726969719301,-0.203055438773104,-2.65259931044169,0.352056079474702,0.33370993968339,0.956984287001654,0.687351504898183,1.24352617743068,-0.790818995349099,-0.338464992418278,0.947529364211218,-1.2493067222675,-0.183544804555741,1.36860057746265,-1.82480691882272,-0.263722468810801,1.14035817898821,-0.848290806250424,1.43678697198291,-0.62459205955957,0.694251649538908,-0.633930776425952,-0.0721167857379795,-1.09145912951172,-0.774243144727338,0.694251649538908,0.694251649538908,-0.660488081741407,-0.785490011789854,0.328530177062648,1.09088522521141,0.851379760603143,0.782560139798466,0.749584409264701,1.43678697198291,0.501672617804506,-0.767352027374792,0.553595914956498,1.16873462589835,-0.940182266611704,-0.203912525461104,1.16880638672465,1.09088522521141,0.269038773453256,0.694251649538908,-0.296476936573002,0.335630708214244,-0.570558778760137,-0.629402593905953,-0.2252555731406,-2.24748887929723,-1.3896494425596,0.694251649538908,0.117923922448378,1.27092073255041,-0.187837013847756,-2.17049681267055]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>help<\/th>\n      <th>voice<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"autoFill":true,"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"deferRender":true,"scrollY":200,"scroller":true,"columnDefs":[{"targets":0,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[0,1]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>
</div>
</div>
<div id="mcp" class="section level3">
<h3 class="hasAnchor">
<a href="#mcp" class="anchor"></a>Mcp</h3>
<p>We can fit a penalized factor model with the mcp penalty in a way similar to what was done above for the scad. By default the shape parameter of the scad is set to 3. This value can be conveniently modified by users through the <code>a.mcp</code> argument. See <code><a href="../reference/penfaOptions.html">?penfaOptions</a></code> for additional details on the possible options.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">eta.grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, length.out <span class="op">=</span> <span class="fl">51</span><span class="op">)</span>
<span class="va">GBIC.mcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">eta.grid</span>, <span class="va">penfa.fixedTun</span>, penalty <span class="op">=</span> <span class="st">"mcp"</span><span class="op">)</span>

<span class="va">optimtun.mcp</span> <span class="op">&lt;-</span> <span class="va">eta.grid</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">GBIC.mcp</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>
<span class="va">q</span> <span class="op">&lt;-</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">eta.grid</span>, y <span class="op">=</span> <span class="va">GBIC.mcp</span>, type <span class="op">=</span> <span class="st">'scatter'</span>, mode <span class="op">=</span> <span class="st">'lines'</span><span class="op">)</span>
<span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/layout.html">layout</a></span><span class="op">(</span><span class="va">q</span>,  xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>showline <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
               title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"GBIC values across tuning parameters"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-25b6a0e16316d44050cc" style="width:576px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-25b6a0e16316d44050cc">{"x":{"visdat":{"454c1a235bb7":["function () ","plotlyVisDat"]},"cur_data":"454c1a235bb7","attrs":{"454c1a235bb7":{"x":[0,0.002,0.004,0.006,0.008,0.01,0.012,0.014,0.016,0.018,0.02,0.022,0.024,0.026,0.028,0.03,0.032,0.034,0.036,0.038,0.04,0.042,0.044,0.046,0.048,0.05,0.052,0.054,0.056,0.058,0.06,0.062,0.064,0.066,0.068,0.07,0.072,0.074,0.076,0.078,0.08,0.082,0.084,0.086,0.088,0.09,0.092,0.094,0.096,0.098,0.1],"y":[17396.1792565921,17389.6391867976,17385.5935793265,17381.8985595585,17379.1293744758,17376.6769673636,17376.3984090847,17371.6253945648,17365.8265871592,17363.7258104133,17361.9822231295,17360.6884209484,17358.193314763,17357.9275889367,17355.5964925657,17355.6061477839,17355.0291111854,17354.5985531795,17354.2739316285,17354.0232997937,17353.8377208246,17353.6947504621,17353.581823582,17353.4932029802,17353.4181261318,17353.218655709,17353.1455584982,17353.1869279438,17352.9961910066,17352.7496327931,17352.493304288,17352.2616702886,17352.1465621971,17351.8134442289,17351.4569616251,17351.1355675009,17350.8362712574,17350.48759533,17350.1447759115,17349.8421009111,17349.6105449369,17349.3484898396,17349.1025940873,17348.8992591228,17348.7314003888,17348.9485834663,17348.9842315518,17349.052631636,17349.1521395547,17349.2485769264,17349.3563408884],"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"showline":true,"title":[]},"title":{"text":"GBIC values across tuning parameters"},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0,0.002,0.004,0.006,0.008,0.01,0.012,0.014,0.016,0.018,0.02,0.022,0.024,0.026,0.028,0.03,0.032,0.034,0.036,0.038,0.04,0.042,0.044,0.046,0.048,0.05,0.052,0.054,0.056,0.058,0.06,0.062,0.064,0.066,0.068,0.07,0.072,0.074,0.076,0.078,0.08,0.082,0.084,0.086,0.088,0.09,0.092,0.094,0.096,0.098,0.1],"y":[17396.1792565921,17389.6391867976,17385.5935793265,17381.8985595585,17379.1293744758,17376.6769673636,17376.3984090847,17371.6253945648,17365.8265871592,17363.7258104133,17361.9822231295,17360.6884209484,17358.193314763,17357.9275889367,17355.5964925657,17355.6061477839,17355.0291111854,17354.5985531795,17354.2739316285,17354.0232997937,17353.8377208246,17353.6947504621,17353.581823582,17353.4932029802,17353.4181261318,17353.218655709,17353.1455584982,17353.1869279438,17352.9961910066,17352.7496327931,17352.493304288,17352.2616702886,17352.1465621971,17351.8134442289,17351.4569616251,17351.1355675009,17350.8362712574,17350.48759533,17350.1447759115,17349.8421009111,17349.6105449369,17349.3484898396,17349.1025940873,17348.8992591228,17348.7314003888,17348.9485834663,17348.9842315518,17349.052631636,17349.1521395547,17349.2485769264,17349.3563408884],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>The tuning value equal to 0.088 generated the model with the lowest value of the tuning parameter.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mcp.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfa.html">penfa</a></span><span class="op">(</span><span class="co">## factor model </span>
                 model <span class="op">=</span> <span class="va">syntax</span>, 
                 data <span class="op">=</span> <span class="va">ccdata</span>, 
                 std.lv <span class="op">=</span> <span class="cn">TRUE</span>, 
                 <span class="co">## penalization</span>
                 pen.shrink <span class="op">=</span> <span class="st">"mcp"</span>, 
                 <span class="co"># optimal tuning</span>
                 eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="va">optimtun.mcp</span><span class="op">)</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
                 strategy <span class="op">=</span> <span class="st">"fixed"</span>, 
                 verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mcp.fit</span><span class="op">)</span>
<span class="co">## penfa 0.0.0.9000 reached convergence</span>
<span class="co">## </span>
<span class="co">##   Number of observations                                    767</span>
<span class="co">##   Number of groups                                            1</span>
<span class="co">##   Number of observed variables                               12</span>
<span class="co">##   Number of latent factors                                    2</span>
<span class="co">##                                                                </span>
<span class="co">##   Estimator                                                PMLE</span>
<span class="co">##   Optimization method                              trust-region</span>
<span class="co">##   Information                                            fisher</span>
<span class="co">##   Strategy                                                fixed</span>
<span class="co">##   Number of iterations                                       27</span>
<span class="co">##   Number of parameters:                                        </span>
<span class="co">##     Free                                                     13</span>
<span class="co">##     Penalized                                                22</span>
<span class="co">##   Effective degrees of freedom                           27.155</span>
<span class="co">##   GIC                                                 17222.663</span>
<span class="co">##   GBIC                                                17348.731</span>
<span class="co">##                                                                </span>
<span class="co">##   Penalty function:                                            </span>
<span class="co">##     Sparsity                                                mcp</span>
<span class="co">##                                                                </span>
<span class="co">##   Additional tuning parameter                                  </span>
<span class="co">##     mcp                                                       3</span>
<span class="co">##                                                                </span>
<span class="co">##   Optimal tuning parameter:                                    </span>
<span class="co">##     Sparsity                                                   </span>
<span class="co">##      - Factor loadings                                    0.088</span>
<span class="co">##                                                                </span>
<span class="co">## </span>
<span class="co">## Parameter Estimates:</span>
<span class="co">## </span>
<span class="co">## Latent Variables:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help =~                                                      </span>
<span class="co">##     h1               pen       0.782    0.030    0.723    0.842</span>
<span class="co">##     h2               pen       0.875    0.029    0.819    0.931</span>
<span class="co">##     h3               pen       0.791    0.030    0.731    0.850</span>
<span class="co">##     h4               pen       0.904    0.029    0.847    0.961</span>
<span class="co">##     h5               pen       0.795    0.041    0.715    0.875</span>
<span class="co">##     h6               pen       0.754    0.044    0.667    0.841</span>
<span class="co">##     h7               pen       0.491    0.051    0.391    0.590</span>
<span class="co">##     v1             fixed       0.000             0.000    0.000</span>
<span class="co">##     v2               pen       0.000                           </span>
<span class="co">##     v3               pen       0.004                           </span>
<span class="co">##     v4               pen       0.000                           </span>
<span class="co">##     v5               pen      -0.000                           </span>
<span class="co">##   voice =~                                                     </span>
<span class="co">##     h1             fixed       0.000             0.000    0.000</span>
<span class="co">##     h2               pen      -0.000                           </span>
<span class="co">##     h3               pen       0.000                           </span>
<span class="co">##     h4               pen      -0.005                           </span>
<span class="co">##     h5               pen       0.083    0.033    0.019    0.147</span>
<span class="co">##     h6               pen       0.149    0.039    0.072    0.226</span>
<span class="co">##     h7               pen       0.390    0.050    0.292    0.489</span>
<span class="co">##     v1               pen       0.865    0.029    0.809    0.922</span>
<span class="co">##     v2               pen       0.885    0.028    0.830    0.941</span>
<span class="co">##     v3               pen       0.850    0.030    0.792    0.909</span>
<span class="co">##     v4               pen       0.855    0.029    0.798    0.912</span>
<span class="co">##     v5               pen       0.816    0.030    0.758    0.875</span>
<span class="co">## </span>
<span class="co">## Covariances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help ~~                                                      </span>
<span class="co">##     voice           free       0.874    0.012    0.851    0.897</span>
<span class="co">## </span>
<span class="co">## Variances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##    .h1              free       0.383    0.021    0.341    0.424</span>
<span class="co">##    .h2              free       0.228    0.014    0.201    0.256</span>
<span class="co">##    .h3              free       0.369    0.021    0.329    0.409</span>
<span class="co">##    .h4              free       0.185    0.012    0.161    0.209</span>
<span class="co">##    .h5              free       0.237    0.014    0.209    0.265</span>
<span class="co">##    .h6              free       0.204    0.012    0.180    0.228</span>
<span class="co">##    .h7              free       0.265    0.015    0.236    0.294</span>
<span class="co">##    .v1              free       0.244    0.015    0.214    0.273</span>
<span class="co">##    .v2              free       0.208    0.013    0.182    0.235</span>
<span class="co">##    .v3              free       0.262    0.016    0.231    0.293</span>
<span class="co">##    .v4              free       0.261    0.016    0.230    0.291</span>
<span class="co">##    .v5              free       0.327    0.019    0.290    0.364</span>
<span class="co">##     help           fixed       1.000             1.000    1.000</span>
<span class="co">##     voice          fixed       1.000             1.000    1.000</span></code></pre></div>
</div>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p>Implementing the above approach in the multiple-group case would imply carrying out grid searches in three dimensions to find the optimal tuning parameter vector. This is clearly not advisable, as it would introduce further complications and possibly new computational problems and instabilities. For this reason, we suggest users to rely on the automatic tuning parameter selection procedure, whose applicability and merits are demonstrated in the package vignettes for single and multiple-group penalized models: see <code><a href="../articles/penalized-factor-analysis.html">vignette("penalized-factor-analysis")</a></code> and <code><a href="../articles/penalized-multigroup-factor-analysis.html">vignette("penalized-multigroup-factor-analysis")</a></code></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-fan2001variable" class="csl-entry">
Fan, Jianqing, and Runze Li. 2001. <span>“Variable Selection via Nonconcave Penalized Likelihood and Its Oracle Properties.”</span> <em>Journal of the American Statistical Association</em> 96 (456): 1348–60.
</div>
<div id="ref-fischer2019does" class="csl-entry">
Fischer, Ronald, Maria Cristina Ferreira, Nathalie Van Meurs, Kubilay Gok, Ding-Yu Jiang, Johnny RJ Fontaine, Charles Harb, et al. 2019. <span>“Does Organizational Formalization Facilitate Voice and Helping Organizational Citizenship Behaviors? It Depends on (National) Uncertainty Norms.”</span> <em>Journal of International Business Studies</em> 50 (1): 125–34.
</div>
<div id="ref-fischer2019primer" class="csl-entry">
Fischer, Ronald, and Johannes Alfons Karl. 2019. <span>“A Primer to (Cross-Cultural) Multi-Group Invariance Testing Possibilities in r.”</span> <em>Frontiers in Psychology</em> 10: 1507.
</div>
<div id="ref-geminiani2020penalized" class="csl-entry">
Geminiani, Elena. 2020. <span>“A Penalized Likelihood-Based Framework for Single and Multiple-Group Factor Analysis Models.”</span> PhD thesis, University of Bologna. <a href="http://amsdottorato.unibo.it/9355/">http://amsdottorato.unibo.it/9355/</a>.
</div>
<div id="ref-geminiani2021single" class="csl-entry">
Geminiani, Elena, Giampiero Marra, and Irini Moustaki. 2021. <span>“Single and Multiple-Group Penalized Factor Analysis: A Trust-Region Algorithm Approach with Integrated Automatic Multiple Tuning Parameter Selection.”</span> <em>Psychometrika</em> 0: 0.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Elena Geminiani, Giampiero Marra.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
